# MySQL 的业务设计

## 逻辑设计

### 范式设计

#### 第一范式：确保每列保持原子性

- 数据库表中的所有字段都只具有单一属性
- 单一属性的列是由基本数据类型锁构成的
- 设计出来的表都是简单的二维表

#### 第二范式：确保表中的每列都和主键相关

- 要求表中只有一个业务主键，也就是说符合第二范式的表不能存在非主键列只对部分主键的依赖关系


#### 第三范式：确保每列都和主键列直接相关，而不是间接相关

- 指每一个非主属性既不部分依赖于也不传递依赖于业务主键，也就是在第二范式的基础上相处了非逐渐对主键的传递依赖

#### 满足三大范式之后的问题

大量的表关联非常影响查询性能，完全符合凡是话的设计有时并不能得到良好的 SQL 查询性能

### 反范式设计

- 反范式话是针对凡是话而言的
- 所谓的反范式话就是为了性能和读取效率的考虑而适当的对数据库设计范式的要求进行违反
- 允许存在少量的冗余，换句话来说反范式话就是使用空间来换取时间

### 总结

- 不能完全按照范式的要求进行设计
- 考虑以后如何使用表

## 物理设计

根据所选择的关系型数据库的特点对逻辑模型进行存储结构的设计

- 定义数据库、表以及字段的命名规范
- 选择合适的存储引擎
- 为表中的字段选择合适的数据类型
- 建立数据库结构

### 命名规范

- 数据库、表、字段名要遵守可读性原则，使用大小写(或下划线)来格式化库对象名字以获得良好的可读性，如使用customAddress而不是customaddress
- 数据库、表、字段名要遵守表意性原则，对象的名字应该能够描述它锁表示的对象，例如，对于表，表的名称应该能够体现表中存储的数据内容；对于存储过程，名称应该能够体现存储过程的功能
- 数据库、表、字段的命名要遵守长名原则，尽可能少食用或者不使用缩写

### 存储引擎选择

|对比项|MyISAM|InnoDB|
|:---|:---|:---|
|主外键|不支持|支持|
|事务|不支持|支持|
|行表锁|表锁，即使操作一条记录也会锁住整个表，不适合高并发操作|行锁，操作时只锁某一行，不对其他行有影响，适合高并发操作|
|缓存|置换成索引，不换成真实数据|不仅缓存索引，还要缓存数据，对内存要求较高，而且内存大小对性能有一定影响|
|表空间|小|大|
|关注点|性能|事务|
|默认安装|Y|Y|

### 数据类型选择

为表中的字段选择合适的数据类型，当一个列可以选择多种数据类型时

- 优先考虑考虑数字类型
- 其次是日期、时间类型
- 最后是字符类型
- 对于相同级别的数据类型，应该优先选择占用空间小的数据类型

浮点类型

|类型|存储空间(字节)|精确类型|
|:---|:---|:---|
|float|4|否|
|double|8|否|
|decimal|每4个字节存9个数字，小数点占1个字节|是|

日期类型，datetime和timestamp(有时区)